{"version":3,"sources":["directives.js"],"names":[],"mappings":"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","file":"/Users/tbosch/projects/angular2/modules/angular2/src/forms/directives.js","sourcesContent":["import {Template, Component, Decorator, Ancestor, onChange, PropertySetter} from 'angular2/angular2';\nimport {Optional} from 'angular2/di';\nimport {isBlank, isPresent, isString, CONST} from 'angular2/src/facade/lang';\nimport {StringMapWrapper, ListWrapper} from 'angular2/src/facade/collection';\nimport {ControlGroup, Control} from './model';\nimport {Validators} from './validators';\n\n//export interface ControlValueAccessor {\n//  writeValue(value):void{}\n//  set onChange(fn){}\n//}\n\n@Decorator({\n  selector: '[control]',\n  events: {\n    'change' : 'onChange($event.target.value)',\n    'input' : 'onChange($event.target.value)'\n  }\n})\nexport class DefaultValueAccessor {\n  _setValueProperty:Function;\n  onChange:Function;\n\n  constructor(@PropertySetter('value') setValueProperty:Function) {\n    this._setValueProperty = setValueProperty;\n    this.onChange = (_) => {};\n  }\n\n  writeValue(value) {\n    this._setValueProperty(value);\n  }\n}\n\n@Decorator({\n  selector: 'input[type=checkbox]', //should be input[type=checkbox][control]\n  // change the selector once https://github.com/angular/angular/issues/1025 is fixed\n  events: {\n    'change' : 'onChange($event.target.checked)'\n  }\n})\nexport class CheckboxControlValueAccessor {\n  _setCheckedProperty:Function;\n  onChange:Function;\n\n  constructor(cd:ControlDirective, @PropertySetter('checked') setCheckedProperty:Function) {\n    this._setCheckedProperty = setCheckedProperty;\n    this.onChange = (_) => {};\n    cd.valueAccessor = this; //ControlDirective should inject CheckboxControlDirective\n  }\n\n  writeValue(value) {\n    this._setCheckedProperty(value);\n  }\n}\n\n@Decorator({\n  lifecycle: [onChange],\n  selector: '[control]',\n  bind: {\n    'controlOrName' : 'control'\n  }\n})\nexport class ControlDirective {\n  _groupDirective:ControlGroupDirective;\n\n  controlOrName:any;\n  valueAccessor:any; //ControlValueAccessor\n\n  validator:Function;\n\n  constructor(@Optional() @Ancestor() groupDirective:ControlGroupDirective, valueAccessor:DefaultValueAccessor)  {\n    this._groupDirective = groupDirective;\n    this.controlOrName = null;\n    this.valueAccessor = valueAccessor;\n    this.validator = Validators.nullValidator;\n  }\n\n  // TODO: vsavkin this should be moved into the constructor once static bindings\n  // are implemented\n  onChange(_) {\n    this._initialize();\n  }\n\n  _initialize() {\n    if(isPresent(this._groupDirective)) {\n      this._groupDirective.addDirective(this);\n    }\n\n    var c = this._control();\n    c.validator = Validators.compose([c.validator, this.validator]);\n\n    this._updateDomValue();\n    this._setUpUpdateControlValue();\n  }\n\n  _updateDomValue() {\n    this.valueAccessor.writeValue(this._control().value);\n  }\n\n  _setUpUpdateControlValue() {\n    this.valueAccessor.onChange = (newValue) => this._control().updateValue(newValue);\n  }\n\n  _control() {\n    if (isString(this.controlOrName)) {\n      return this._groupDirective.findControl(this.controlOrName);\n    } else {\n      return this.controlOrName;\n    }\n  }\n}\n\n@Decorator({\n  selector: '[control-group]',\n  bind: {\n    'controlGroup' : 'control-group'\n  }\n})\nexport class ControlGroupDirective {\n  _groupDirective:ControlGroupDirective;\n  _controlGroupName:string;\n\n  _controlGroup:ControlGroup;\n  _directives:List<ControlDirective>;\n\n  constructor(@Optional() @Ancestor() groupDirective:ControlGroupDirective) {\n    this._groupDirective = groupDirective;\n    this._directives = ListWrapper.create();\n  }\n\n  set controlGroup(controlGroup) {\n    if (isString(controlGroup)) {\n      this._controlGroupName = controlGroup;\n    } else {\n      this._controlGroup = controlGroup;\n    }\n    this._updateDomValue();\n  }\n\n  _updateDomValue() {\n    ListWrapper.forEach(this._directives, (cd) => cd._updateDomValue());\n  }\n\n  addDirective(c:ControlDirective) {\n    ListWrapper.push(this._directives, c);\n  }\n\n  findControl(name:string):any {\n    return this._getControlGroup().controls[name];\n  }\n\n  _getControlGroup():ControlGroup {\n    if (isPresent(this._controlGroupName)) {\n      return this._groupDirective.findControl(this._controlGroupName)\n    } else {\n      return this._controlGroup;\n    }\n  }\n}\n\nexport var FormDirectives = [\n  ControlGroupDirective, ControlDirective, CheckboxControlValueAccessor, DefaultValueAccessor\n];\n"]}