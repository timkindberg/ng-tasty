{"version":3,"sources":["compile_element.js"],"names":[],"mappings":"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","file":"/Users/tbosch/projects/angular2/modules/angular2/src/core/compiler/pipeline/compile_element.js","sourcesContent":["import {List, Map, ListWrapper, MapWrapper} from 'angular2/src/facade/collection';\nimport {DOM} from 'angular2/src/dom/dom_adapter';\nimport {int, isBlank, isPresent, Type, StringJoiner, assertionsEnabled} from 'angular2/src/facade/lang';\nimport {DirectiveMetadata} from '../directive_metadata';\nimport {Decorator, Component, Viewport, DynamicComponent} from '../../annotations/annotations';\nimport {ElementBinder} from '../element_binder';\nimport {ProtoElementInjector} from '../element_injector';\nimport * as viewModule from '../view';\nimport {dashCaseToCamelCase} from '../string_utils';\n\nimport {AST} from 'angular2/change_detection';\n\n/**\n * Collects all data that is needed to process an element\n * in the compile process. Fields are filled\n * by the CompileSteps starting out with the pure HTMLElement.\n */\nexport class CompileElement {\n  element;\n  _attrs:Map;\n  _classList:List;\n  textNodeBindings:Map;\n  propertyBindings:Map;\n  eventBindings:Map;\n  attributes:Map;\n\n  /// Store directive name to template name mapping.\n  /// Directive name is what the directive exports the variable as\n  /// Template name is how it is reffered to it in template\n  variableBindings:Map;\n  decoratorDirectives:List<DirectiveMetadata>;\n  viewportDirective:DirectiveMetadata;\n  componentDirective:DirectiveMetadata;\n  hasNestedView:boolean;\n  _allDirectives:List<DirectiveMetadata>;\n  isViewRoot:boolean;\n  hasBindings:boolean;\n  inheritedProtoView:viewModule.ProtoView;\n  inheritedProtoElementInjector:ProtoElementInjector;\n  inheritedElementBinder:ElementBinder;\n  distanceToParentInjector:int;\n  distanceToParentBinder:int;\n  compileChildren: boolean;\n  ignoreBindings: boolean;\n  elementDescription: string; // e.g. '<div [class]=\"foo\">' : used to provide context in case of error\n  contentTagSelector: string;\n\n  constructor(element, compilationUnit = '') {\n    this.element = element;\n    this._attrs = null;\n    this._classList = null;\n    this.textNodeBindings = null;\n    this.propertyBindings = null;\n    this.eventBindings = null;\n    this.variableBindings = null;\n    this.decoratorDirectives = null;\n    this.viewportDirective = null;\n    this.componentDirective = null;\n    this.hasNestedView = false;\n    this._allDirectives = null;\n    this.isViewRoot = false;\n    this.hasBindings = false;\n    // inherited down to children if they don't have\n    // an own protoView\n    this.inheritedProtoView = null;\n    // inherited down to children if they don't have\n    // an own protoElementInjector\n    this.inheritedProtoElementInjector = null;\n    // inherited down to children if they don't have\n    // an own elementBinder\n    this.inheritedElementBinder = null;\n    this.distanceToParentInjector = 0;\n    this.distanceToParentBinder = 0;\n    this.compileChildren = true;\n    // set to true to ignore all the bindings on the element\n    this.ignoreBindings = false;\n    this.contentTagSelector = null;\n    // description is calculated here as compilation steps may change the element\n    var tplDesc = assertionsEnabled()? getElementDescription(element) : null;\n    if (compilationUnit !== '') {\n      this.elementDescription = compilationUnit;\n      if (isPresent(tplDesc)) this.elementDescription += \": \" + tplDesc;\n    } else {\n      this.elementDescription = tplDesc;\n    }\n  }\n\n  refreshAttrs() {\n    this._attrs = null;\n  }\n\n  attrs():Map<string,string> {\n    if (isBlank(this._attrs)) {\n      this._attrs = DOM.attributeMap(this.element);\n    }\n    return this._attrs;\n  }\n\n  refreshClassList() {\n    this._classList = null;\n  }\n\n  classList():List<string> {\n    if (isBlank(this._classList)) {\n      this._classList = ListWrapper.create();\n      var elClassList = DOM.classList(this.element);\n      for (var i = 0; i < elClassList.length; i++) {\n        ListWrapper.push(this._classList, elClassList[i]);\n      }\n    }\n    return this._classList;\n  }\n\n  addTextNodeBinding(indexInParent:int, expression:AST) {\n    if (isBlank(this.textNodeBindings)) {\n      this.textNodeBindings = MapWrapper.create();\n    }\n    MapWrapper.set(this.textNodeBindings, indexInParent, expression);\n  }\n\n  addPropertyBinding(property:string, expression:AST) {\n    if (isBlank(this.propertyBindings)) {\n      this.propertyBindings = MapWrapper.create();\n    }\n    MapWrapper.set(this.propertyBindings, dashCaseToCamelCase(property), expression);\n  }\n\n  addVariableBinding(variableName:string, variableValue:string) {\n    if (isBlank(this.variableBindings)) {\n      this.variableBindings = MapWrapper.create();\n    }\n\n    // Store the variable map from value to variable, reflecting how it will be used later by\n    // View. When a local is set to the view, a lookup for the variable name will take place keyed\n    // by the \"value\", or exported identifier. For example, ng-repeat sets a view local of \"index\".\n    // When this occurs, a lookup keyed by \"index\" must occur to find if there is a var referencing\n    // it.\n    MapWrapper.set(this.variableBindings, variableValue, dashCaseToCamelCase(variableName));\n  }\n\n  addEventBinding(eventName:string, expression:AST) {\n    if (isBlank(this.eventBindings)) {\n      this.eventBindings = MapWrapper.create();\n    }\n    MapWrapper.set(this.eventBindings, eventName, expression);\n  }\n\n  addAttribute(attributeName:string, attributeValue:string) {\n    if (isBlank(this.attributes)) {\n      this.attributes = MapWrapper.create();\n    }\n    MapWrapper.set(this.attributes, attributeName, attributeValue);\n  }\n\n  addDirective(directive:DirectiveMetadata) {\n    var annotation = directive.annotation;\n    this._allDirectives = null;\n    if (annotation instanceof Decorator) {\n      if (isBlank(this.decoratorDirectives)) {\n        this.decoratorDirectives = ListWrapper.create();\n      }\n      ListWrapper.push(this.decoratorDirectives, directive);\n      if (!annotation.compileChildren) {\n        this.compileChildren = false;\n      }\n    } else if (annotation instanceof Viewport) {\n      this.viewportDirective = directive;\n    } else if (annotation instanceof Component) {\n      this.componentDirective = directive;\n      this.hasNestedView = true;\n    } else if (annotation instanceof DynamicComponent) {\n      this.componentDirective = directive;\n    }\n  }\n\n  getAllDirectives(): List<DirectiveMetadata> {\n    if (this._allDirectives === null) {\n      // Collect all the directives\n      // When present the component directive must be first\n      var directives = ListWrapper.create();\n      if (isPresent(this.componentDirective)) {\n        ListWrapper.push(directives, this.componentDirective);\n      }\n      if (isPresent(this.viewportDirective)) {\n        ListWrapper.push(directives, this.viewportDirective);\n      }\n      if (isPresent(this.decoratorDirectives)) {\n        directives = ListWrapper.concat(directives, this.decoratorDirectives);\n      }\n      this._allDirectives = directives;\n    }\n    return this._allDirectives;\n  }\n}\n\n// return an HTML representation of an element start tag - without its content\n// this is used to give contextual information in case of errors\nfunction getElementDescription(domElement):string {\n  var buf = new StringJoiner();\n  var atts = DOM.attributeMap(domElement);\n\n  buf.add(\"<\");\n  buf.add(DOM.tagName(domElement).toLowerCase());\n\n  // show id and class first to ease element identification\n  addDescriptionAttribute(buf, \"id\", MapWrapper.get(atts, \"id\"));\n  addDescriptionAttribute(buf, \"class\", MapWrapper.get(atts, \"class\"));\n  MapWrapper.forEach(atts, (attValue, attName) => {\n      if (attName !== \"id\" && attName !== \"class\") {\n          addDescriptionAttribute(buf, attName, attValue);\n      }\n  });\n\n  buf.add(\">\");\n  return buf.toString();\n}\n\n\nfunction addDescriptionAttribute(buffer:StringJoiner, attName:string, attValue) {\n  if (isPresent(attValue)) {\n      if (attValue.length === 0) {\n          buffer.add(' ' + attName);\n      } else {\n          buffer.add(' ' + attName + '=\"' + attValue + '\"');\n      }\n  }\n}\n"]}